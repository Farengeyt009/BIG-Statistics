# Task Manager - Backend

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–∞—Å–∫-–º–µ–Ω–µ–¥–∂–µ—Ä —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø—Ä–∞–≤, –≤–æ—Ä–∫—Ñ–ª–æ—É, —Ç–µ–≥–∞–º–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
TaskManager/
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îî‚îÄ‚îÄ create_tables.sql          # SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ projects_api.py            # API –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ tasks_api.py               # API –∑–∞–¥–∞—á
‚îÇ   ‚îú‚îÄ‚îÄ workflow_api.py            # API –≤–æ—Ä–∫—Ñ–ª–æ—É (—Å—Ç–∞—Ç—É—Å—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã)
‚îÇ   ‚îú‚îÄ‚îÄ tags_api.py                # API —Ç–µ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ comments_api.py            # API –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ attachments_api.py         # API –≤–ª–æ–∂–µ–Ω–∏–π
‚îî‚îÄ‚îÄ service/
    ‚îú‚îÄ‚îÄ projects_service.py        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
    ‚îú‚îÄ‚îÄ tasks_service.py           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∑–∞–¥–∞—á
    ‚îú‚îÄ‚îÄ workflow_service.py        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤–æ—Ä–∫—Ñ–ª–æ—É
    ‚îú‚îÄ‚îÄ tags_service.py            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ç–µ–≥–æ–≤
    ‚îú‚îÄ‚îÄ comments_service.py        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    ‚îî‚îÄ‚îÄ attachments_service.py     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ MSSQL

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –∏–∑ —Ñ–∞–π–ª–∞ `sql/create_tables.sql` –≤ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö MSSQL:

```sql
-- –û—Ç–∫—Ä–æ–π—Ç–µ SSMS (SQL Server Management Studio)
-- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
-- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª Back/TaskManager/sql/create_tables.sql
-- –ù–∞–∂–º–∏—Ç–µ F5 –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:
- `project_categories` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `projects` - –ø—Ä–æ–µ–∫—Ç—ã
- `project_members` - —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `workflow_statuses` - —Å—Ç–∞—Ç—É—Å—ã –≤–æ—Ä–∫—Ñ–ª–æ—É
- `workflow_transitions` - –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å—Ç–∞—Ç—É—Å–∞–º–∏
- `tags` - —Ç–µ–≥–∏
- `tasks` - –∑–∞–¥–∞—á–∏
- `task_tags` - —Å–≤—è–∑—å –∑–∞–¥–∞—á —Å —Ç–µ–≥–∞–º–∏
- `task_attachments` - –≤–ª–æ–∂–µ–Ω–∏—è
- `task_comments` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- `task_history` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è API (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)

API endpoints —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `Back/Run_Server.py`.

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `uploads/task_attachments` –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞.

## API Endpoints

### –ü—Ä–æ–µ–∫—Ç—ã

#### GET `/api/task-manager/projects/`
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Headers:**
```
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "–ü—Ä–æ–µ–∫—Ç 1",
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "category_id": 1,
      "category_name": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
      "owner_id": 1,
      "owner_name": "admin",
      "user_role": "owner",
      "has_workflow_permissions": false,
      "task_count": 5,
      "member_count": 3
    }
  ]
}
```

#### POST `/api/task-manager/projects/`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

**Body:**
```json
{
  "name": "–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞",
  "category_id": 1,
  "has_workflow_permissions": false
}
```

#### PUT `/api/task-manager/projects/<project_id>`
–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç (—Ç–æ–ª—å–∫–æ owner)

#### DELETE `/api/task-manager/projects/<project_id>`
–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç (—Ç–æ–ª—å–∫–æ owner)

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

#### GET `/api/task-manager/projects/categories/all`
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

#### POST `/api/task-manager/projects/categories`
–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é

**Body:**
```json
{
  "name": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
  "description": "–ü—Ä–æ–µ–∫—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
  "icon": "code",
  "color": "#3b82f6"
}
```

### –£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

#### GET `/api/task-manager/projects/<project_id>/members`
–ü–æ–ª—É—á–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

#### POST `/api/task-manager/projects/<project_id>/members`
–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞

**Body:**
```json
{
  "user_id": 2,
  "role": "member"
}
```

–†–æ–ª–∏: `owner`, `admin`, `member`, `viewer`

### –ó–∞–¥–∞—á–∏

#### GET `/api/task-manager/tasks/project/<project_id>`
–ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞

**Query Parameters:**
- `parent_task_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á

#### POST `/api/task-manager/tasks/`
–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É

**Body:**
```json
{
  "project_id": 1,
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "status_id": 1,
  "assignee_id": 2,
  "priority": "high",
  "due_date": "2025-12-31",
  "parent_task_id": null,
  "tag_ids": [1, 2]
}
```

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: `low`, `medium`, `high`, `critical`

#### PUT `/api/task-manager/tasks/<task_id>`
–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É

#### DELETE `/api/task-manager/tasks/<task_id>`
–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É (—Ç–æ–ª—å–∫–æ owner –∏–ª–∏ admin)

### –í–æ—Ä–∫—Ñ–ª–æ—É

#### GET `/api/task-manager/workflow/projects/<project_id>/statuses`
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã –ø—Ä–æ–µ–∫—Ç–∞

#### POST `/api/task-manager/workflow/statuses`
–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—É—Å (—Ç–æ–ª—å–∫–æ owner –∏–ª–∏ admin)

**Body:**
```json
{
  "project_id": 1,
  "name": "–í —Ä–∞–±–æ—Ç–µ",
  "color": "#3b82f6",
  "order_index": 1,
  "is_initial": false,
  "is_final": false
}
```

#### GET `/api/task-manager/workflow/projects/<project_id>/transitions`
–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã –≤–æ—Ä–∫—Ñ–ª–æ—É

#### POST `/api/task-manager/workflow/transitions`
–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ (—Ç–æ–ª—å–∫–æ owner –∏–ª–∏ admin)

**Body:**
```json
{
  "project_id": 1,
  "from_status_id": 1,
  "to_status_id": 2,
  "name": "–í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É",
  "allowed_roles": ["owner", "admin", "member"]
}
```

### –¢–µ–≥–∏

#### GET `/api/task-manager/tags/project/<project_id>`
–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞

#### POST `/api/task-manager/tags/`
–°–æ–∑–¥–∞—Ç—å —Ç–µ–≥

**Body:**
```json
{
  "project_id": 1,
  "name": "–°—Ä–æ—á–Ω–æ",
  "color": "#ef4444"
}
```

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

#### GET `/api/task-manager/comments/task/<task_id>`
–ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∑–∞–¥–∞—á–∏

#### POST `/api/task-manager/comments/`
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

**Body:**
```json
{
  "task_id": 1,
  "comment": "–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è"
}
```

### –í–ª–æ–∂–µ–Ω–∏—è

#### GET `/api/task-manager/attachments/task/<task_id>`
–ü–æ–ª—É—á–∏—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

#### POST `/api/task-manager/attachments/task/<task_id>`
–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª

**Content-Type:** `multipart/form-data`

**Form Data:**
```
file: <binary file>
```

#### GET `/api/task-manager/attachments/<attachment_id>/download`
–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª

#### DELETE `/api/task-manager/attachments/<attachment_id>`
–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª

## –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤

### –†–æ–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ:
- **owner** - –≤–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–æ–µ–∫—Ç–∞ (–≤—Å–µ –ø—Ä–∞–≤–∞)
- **admin** - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏, –≤–æ—Ä–∫—Ñ–ª–æ—É)
- **member** - —É—á–∞—Å—Ç–Ω–∏–∫ (—Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á)
- **viewer** - –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)

### –ü—Ä–∞–≤–∞ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è:

| –î–µ–π—Å—Ç–≤–∏–µ | Owner | Admin | Member | Viewer |
|----------|-------|-------|--------|--------|
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| –£–ø—Ä–∞–≤–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤–æ—Ä–∫—Ñ–ª–æ—É | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| –£–¥–∞–ª—è—Ç—å –∑–∞–¥–∞—á–∏ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| –ó–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| –ü—Ä–æ—Å–º–æ—Ç—Ä | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

```bash
curl -X POST http://localhost:5000/api/task-manager/projects/ \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç",
    "description": "–ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
  }'
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

```bash
curl -X GET http://localhost:5000/api/task-manager/projects/ \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

```bash
curl -X POST http://localhost:5000/api/task-manager/tasks/ \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "project_id": 1,
    "title": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞",
    "priority": "high"
  }'
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ Backend –≥–æ—Ç–æ–≤
2. üîÑ Frontend –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `react-trello` –¥–ª—è –∫–∞–Ω–±–∞–Ω–∞
   - –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–¥–∞—á
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å AG Grid –¥–ª—è —Ä–µ–∂–∏–º–∞ —Å–ø–∏—Å–∫–∞
   - –î–æ–±–∞–≤–∏—Ç—å recharts –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

–¢–∞–±–ª–∏—Ü–∞ `task_history` –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–¥–∞—á. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å API endpoint –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏.

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –¢–∞–±–ª–∏—Ü—É `notifications` –≤ –ë–î

